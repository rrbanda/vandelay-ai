Certificate Changes Guide

OVERVIEW

This guide covers certificate management during VMware to BareMetal OpenShift
migration. Depending on your certificate configuration, you may or may not
need to request new certificates.

UNDERSTANDING YOUR CERTIFICATE

Certificates contain a Subject Alternative Name (SAN) list that specifies
which hostnames the certificate is valid for. Review your current certificate
to determine what action is needed.

SCENARIO 1: ONLY VANITY URL IN SAN LIST

If your certificate SAN list contains ONLY your Vanity URL(s):
- Example: payments.vandelay.com, api.payments.vandelay.com

Action Required: NONE

Your existing certificate will work on the BareMetal cluster because:
- Vanity URLs are cluster-independent
- The same URL will be used on the new cluster
- No certificate changes needed

Simply ensure your Vanity URL is pointed to the new cluster VIP after
migration.

SCENARIO 2: CLUSTER-BASED ROUTES IN SAN LIST

If your certificate SAN list contains cluster-specific routes:
- Example: payments-api.apps.vmware-east-dev.example.internal

Action Required: REQUEST NEW CERTIFICATE

You must order a new certificate because:
- The cluster route hostname changes on BareMetal
- Old cluster routes won't resolve to new cluster
- Certificate validation will fail

REQUESTING A NEW CERTIFICATE

Step 1: Create Certificate Policy

1. Navigate to the Service Request Portal
2. Select Certificate Management category
3. Choose "Create Certificate Policy"
4. Fill in the required fields:

   Application ID: Your app ID
   Policy Name: Descriptive name for the policy
   SAN List: List all required hostnames
   
   Include in SAN list:
   - Your Vanity URL (if you have one)
   - New cluster route: <app>-<namespace>.apps.<baremetal-cluster>.example.internal
   - Any other required hostnames

5. Submit the request

Step 2: Order Certificate

1. Once policy is approved, select "Order Certificate"
2. Reference the policy created in Step 1
3. Complete the certificate order form:

   Certificate Type: Select appropriate type
   Key Size: Typically 2048 or 4096
   Validity Period: Per your organization's standards

4. Submit the order

Step 3: Retrieve Certificate

1. Once order is fulfilled, download the certificate
2. Obtain the certificate and private key
3. Store securely according to your security policies

Step 4: Update Application Configuration

1. Create or update the TLS secret in your namespace:

   The secret should contain:
   - tls.crt: Your new certificate
   - tls.key: Your private key

2. Update your route or ingress configuration to reference the new secret

3. Update any application configuration that references certificate paths

CERTIFICATE ROTATION TIMING

Consider these timing recommendations:

Before Migration:
- Order new certificate with both old and new routes in SAN
- This allows testing on new cluster while old is still active

During Migration:
- Deploy application with new certificate
- Validate TLS is working correctly

After Migration:
- Can later order certificate with only new routes
- Remove old cluster routes from SAN list

TROUBLESHOOTING

Issue: Certificate validation fails on new cluster
Cause: SAN list doesn't include new cluster route
Solution: Order new certificate with correct SAN list

Issue: Certificate secret not found
Cause: Secret wasn't copied or has different name
Solution: Verify secret exists in namespace; recreate if needed

Issue: Mixed content warnings
Cause: Some resources still using old routes
Solution: Update all route references in your application

Issue: Certificate chain incomplete
Cause: Intermediate certificates not included
Solution: Ensure full certificate chain is in the secret

BEST PRACTICES

1. Use Vanity URLs: Reduces certificate changes during migrations

2. Plan ahead: Certificate requests can take several days

3. Test thoroughly: Validate certificate works before cutover

4. Document: Keep track of certificate expiration dates

5. Automate: Consider certificate automation tools for renewal

LEAD TIME

Certificate requests typically require:
- Policy creation: 1-2 business days
- Certificate order: 3-5 business days
- Total: Plan for at least 7 days

Submit certificate requests early in your migration preparation.
